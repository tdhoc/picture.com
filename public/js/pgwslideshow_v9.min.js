!(function(i) {
    i.fn.pgwSlideshow = function(t) {
        var n = {
            mainClassName: "pgwSlideshow",
            displayList: !0,
            displayControls: !0,
            touchControls: !0,
            autoSlide: !1,
            directionSlide: "right",
            beforeSlide: !1,
            afterSlide: !1,
            nextPage: "",
            prevPage: "",
            titleAutoForward: "",
            titleAutoBackward: "",
            titlePause: ""
        };
        if (0 == this.length) return this;
        if (this.length > 1)
            return (
                this.each(function() {
                    i(this).pgwSlideshow(t);
                }),
                this
            );
        var e = this;
        (e.plugin = this),
            (e.config = {}),
            (e.data = []),
            (e.currentSlide = 0),
            (e.slideCount = 0),
            (e.resizeEvent = null),
            (e.intervalEvent = null),
            (e.touchFirstPosition = null),
            (e.touchListLastPosition = !1),
            (e.window = i(window));
        i(document.body).on("click", ".pauseSlide", function() {
            e.pauseAutoSlide();
        }),
            i(document.body).on("click", ".backwardSlide", function() {
                e.autoBackward();
            }),
            i(document.body).on("click", ".forwardSlide", function() {
                e.autoForward();
            }),
            i(document.body).on("click", ".moreInfoSlide", showInfos);
        var s = function(i) {
                return (
                    e.slideCount > 1 &&
                        e.config.autoSlide &&
                        e.currentSlide == i &&
                        (e.intervalEvent = setTimeout(function() {
                            if ("left" == e.config.directionSlide)
                                if (e.currentSlide - 1 >= 1) {
                                    var i = e.currentSlide - 1;
                                    u(i);
                                } else
                                    "none" != e.config.prevPage
                                        ? (window.location.href =
                                              e.config.prevPage)
                                        : u(e.slideCount);
                            else if (e.currentSlide + 1 <= e.slideCount) {
                                var t = e.currentSlide + 1;
                                u(t);
                            } else
                                "none" != e.config.nextPage
                                    ? (window.location.href = e.config.nextPage)
                                    : u(1);
                        }, 2500)),
                    !0
                );
            },
            l = function(t, n, s) {
                var l,
                    o,
                    a = i(window).height() - 121;
                return (
                    (l = a),
                    (o = Math.min(n, Math.floor((a * n) / s))),
                    i(window).width() < o &&
                        ((o = i(window).width()),
                        (l = Math.floor((o * s) / n))),
                    (l = Math.min(l, s)),
                    e.plugin
                        .find(".ps-current > ul > li:nth-child(" + t + ")")
                        .css({ width: o + "px", height: l + "px" }),
                    !0
                );
            },
            o = function(t) {
                var n = e.plugin.find(
                        ".ps-current > ul > li:nth-child(" + t + ")"
                    ),
                    s = e.plugin.find(".ps-caption"),
                    l = e.plugin.find(".ps-next"),
                    o = e.plugin.find(".ps-prev");
                if (i(window).height() - n.height() - 121 >= s.height())
                    s.css({
                        display: "inline-block",
                        position: "static",
                        width: "100%"
                    }),
                        l.css("max-height", n.height()),
                        o.css("max-height", n.height());
                else {
                    var a = i(window).width() - n.width();
                    if (a < 92) {
                        var r = 10 + a / 2;
                        s.css({
                            position: "absolute",
                            width: "100%",
                            left: 0,
                            padding: "9px " + r + "px 10px " + r + "px"
                        });
                        var c = n.height() - s.outerHeight();
                        l.css("max-height", c), o.css("max-height", c);
                    } else
                        s.css({
                            position: "absolute",
                            width: n.width() + "px",
                            left: (i(window).width() - n.width()) / 2,
                            padding: "9px 10px 10px"
                        }),
                            l.css("max-height", "none"),
                            o.css("max-height", "none");
                }
            },
            a = function() {
                var t = 0;
                return (
                    e.plugin.show(),
                    e.plugin
                        .find(".ps-list > ul > li")
                        .show()
                        .each(function() {
                            t += i(this).width();
                        }),
                    e.plugin.find(".ps-list > ul").width(t),
                    !0
                );
            },
            r = function() {
                if (
                    (e.plugin
                        .removeClass("pgwSlideshow")
                        .removeClass(e.config.mainClassName),
                    e.plugin.wrap('<div class="ps-list"></div>'),
                    (e.plugin = e.plugin.parent()),
                    e.plugin.wrap(
                        '<div class="' + e.config.mainClassName + '"></div>'
                    ),
                    (e.plugin = e.plugin.parent()),
                    e.plugin.prepend(
                        '<div class="ps-current"><img src="/img/ajax-loader-er.gif" alt=""><ul></ul><span class="ps-caption"></span></div>'
                    ),
                    (e.slideCount = e.plugin.find(".ps-list > ul > li").length),
                    0 == e.slideCount)
                )
                    throw new Error(
                        "pgwSlideshow - No slider item has been found"
                    );
                e.slideCount > 1 &&
                    (e.config.displayControls &&
                        (e.plugin
                            .find(".ps-current")
                            .prepend(
                                '<span class="ps-prev"><i class="ps-navIcon el el-chevron-left"></i></span>'
                            ),
                        e.plugin
                            .find(".ps-current")
                            .append(
                                '<span class="ps-next"><i class="ps-navIcon el el-chevron-right"></i></span>'
                            ),
                        e.plugin.find(".ps-current .ps-prev").click(function() {
                            clearTimeout(e.intervalEvent), e.previousSlide();
                        }),
                        e.plugin.find(".ps-current .ps-next").click(function() {
                            clearTimeout(e.intervalEvent), e.nextSlide();
                        })),
                    e.config.touchControls &&
                        (e.plugin
                            .find(".ps-current")
                            .on("touchstart", function(i) {
                                try {
                                    i.originalEvent.touches[0].clientX &&
                                        null == e.touchFirstPosition &&
                                        (e.touchFirstPosition =
                                            i.originalEvent.touches[0].clientX);
                                } catch (i) {
                                    e.touchFirstPosition = null;
                                }
                            }),
                        e.plugin
                            .find(".ps-current")
                            .on("touchmove", function(i) {
                                try {
                                    i.originalEvent.touches[0].clientX &&
                                        null != e.touchFirstPosition &&
                                        (i.originalEvent.touches[0].clientX >
                                        e.touchFirstPosition + 50
                                            ? ((e.touchFirstPosition = null),
                                              e.previousSlide())
                                            : i.originalEvent.touches[0]
                                                  .clientX <
                                                  e.touchFirstPosition - 50 &&
                                              ((e.touchFirstPosition = null),
                                              e.nextSlide()));
                                } catch (i) {
                                    e.touchFirstPosition = null;
                                }
                            }),
                        e.plugin
                            .find(".ps-current")
                            .on("touchend", function(i) {
                                e.touchFirstPosition = null;
                            })));
                var t = 1;
                return (
                    e.plugin.find(".ps-list > ul > li").each(function() {
                        var n = c(i(this));
                        (n.id = t),
                            e.data.push(n),
                            i(this).addClass("elt_" + n.id),
                            i(this).wrapInner(
                                '<span class="ps-item' +
                                    (1 == t ? " ps-selected" : "") +
                                    '"></span>'
                            );
                        var s = i('<li class="elt_' + t + '"></li>');
                        n.image
                            ? s.html(
                                  '<img id="img_big_' +
                                      t +
                                      '" data-src="' +
                                      n.image +
                                      '" alt="' +
                                      (n.title ? n.title : "") +
                                      '">'
                              )
                            : n.thumbnail &&
                              s.html(
                                  '<img src="' +
                                      n.thumbnail +
                                      '" alt="' +
                                      (n.title ? n.title : "") +
                                      '">'
                              ),
                            n.link &&
                                s.html(
                                    '<a href="' +
                                        n.link +
                                        '"' +
                                        (n.linkTarget
                                            ? ' target="' + n.linkTarget + '"'
                                            : "") +
                                        ">" +
                                        s.html() +
                                        "</a>"
                                ),
                            e.plugin.find(".ps-current > ul").append(s),
                            i(this)
                                .css("cursor", "pointer")
                                .click(function(i) {
                                    i.preventDefault(), u(n.id);
                                }),
                            t++;
                    }),
                    e.config.displayList
                        ? (a(),
                          e.plugin
                              .find(".ps-list")
                              .prepend(
                                  '<span class="ps-prev"><span class="ps-prevIcon-list"></span></span>'
                              ),
                          e.plugin
                              .find(".ps-list")
                              .append(
                                  '<span class="ps-next"><span class="ps-nextIcon-list"></span></span>'
                              ),
                          e.plugin.find(".ps-list").show())
                        : e.plugin.find(".ps-list").hide(),
                    e.plugin.find(".ps-current > ul > li").hide(),
                    u(1),
                    e.plugin.show(),
                    !0
                );
            },
            c = function(i) {
                var t = {},
                    n = i.find("a").attr("href");
                if (void 0 !== n && "" != n) {
                    t.link = n;
                    var e = i.find("a").attr("target");
                    void 0 !== e && "" != e && (t.linkTarget = e);
                }
                var s = i.find("img").attr("src");
                void 0 !== s && "" != s && (t.thumbnail = s);
                var l = i.find("img").attr("data-large-src");
                void 0 !== l && "" != l && (t.image = l);
                var o = i.find("img").attr("alt");
                void 0 !== o && "" != o && (t.title = o);
                var a = i.find("img").attr("data-description");
                void 0 !== a && "" != a && (t.description = a);
                var r = i.find("img").attr("data-width");
                void 0 !== r && "" != r && (t.width = r);
                var c = i.find("img").attr("data-height");
                void 0 !== c && "" != c && (t.height = c);
                var d = i.find("img").attr("data-id");
                return void 0 !== d && "" != d && (t.wallpaper_id = d), t;
            },
            d = function(t) {
                var n = e.plugin.find(".ps-current > ul");
                if (
                    (n
                        .find("li")
                        .not(".elt_" + e.currentSlide)
                        .not(".elt_" + t.id)
                        .each(function() {
                            "function" == typeof i(this).stop && i(this).stop(),
                                i(this)
                                    .css("position", "")
                                    .css("z-index", 1)
                                    .hide();
                        }),
                    e.currentSlide > 0)
                ) {
                    var s = n.find(".elt_" + e.currentSlide);
                    "function" != typeof s.animate &&
                        (s.animate = function(i, t, n) {
                            s.css(i), n && n();
                        }),
                        "function" == typeof s.stop && s.stop(),
                        s.css({ opacity: 0, "z-index": 1 }).hide();
                }
                var l = n.find(".elt_" + t.id);
                return (
                    "function" != typeof l.animate &&
                        (l.animate = function(i, t, n) {
                            l.css(i), n && n();
                        }),
                    "function" == typeof l.stop && l.stop(),
                    l.css({ opacity: 1, "z-index": 2, display: "block" }),
                    (function(i) {
                        var t = "";
                        i.title &&
                            (t +=
                                '<div class="ps-title">' + i.title + "</div>"),
                            (t +=
                                '<div><span class="floatleft">' +
                                i.description +
                                '&nbsp;<a class="el el-lines moreInfoSlide"></a></span>');
                        (t +=
                            '<span class="floatright">' +
                            (e.config.autoSlide
                                ? '<span title="' +
                                  e.config.titleAutoBackward +
                                  '" class="el el-fast-backward backwardSlide"></span><span title="' +
                                  e.config.titlePause +
                                  '" class="el el-pause pauseSlide"></span><span title="' +
                                  e.config.titleAutoForward +
                                  '" class="el el-fast-forward forwardSlide"></span>'
                                : '<span title="' +
                                  e.config.titleAutoBackward +
                                  '" class="el el-fast-backward backwardSlide"></span><span title="' +
                                  e.config.titleAutoForward +
                                  '" class="el el-fast-forward forwardSlide"></span>') +
                            "&nbsp;<span>" +
                            e.currentSlide +
                            "/" +
                            e.slideCount +
                            "</span></span>"),
                            (t += "</div>"),
                            e.plugin.find(".ps-caption").html(t),
                            e.plugin.find(".ps-caption").show(),
                            o(i.id),
                            e.plugin
                                .find(".ps-list > ul > li .ps-item")
                                .removeClass("ps-selected"),
                            e.plugin
                                .find(
                                    ".ps-list > ul > li.elt_" +
                                        i.id +
                                        " .ps-item"
                                )
                                .addClass("ps-selected"),
                            e.config.displayList && (p(), f()),
                            e.config.displayControls &&
                                e.plugin
                                    .find(
                                        ".ps-current > .ps-prev, .ps-current > .ps-next"
                                    )
                                    .show(),
                            "function" == typeof e.config.afterSlide &&
                                e.config.afterSlide(i.id);
                    })(t),
                    !0
                );
            },
            u = function(t) {
                if (
                    (e.config.autoSlide && clearTimeout(e.intervalEvent),
                    t == e.currentSlide)
                )
                    return !1;
                e.currentSlide = t;
                var n = e.data[t - 1];
                if ((l(t, n.width, n.height), void 0 === n))
                    throw new Error(
                        "pgwSlideshow - The element " + t + " is undefined"
                    );
                "function" == typeof e.config.beforeSlide &&
                    e.config.beforeSlide(t),
                    e.plugin.find(".ps-caption, .ps-prev, .ps-next").hide();
                var o = i("#img_big_" + t).attr("data-src");
                return (
                    void 0 !== o && !1 !== o
                        ? i("#img_big_" + t)
                              .attr("src", o)
                              .on("load", function() {
                                  i("#img_big_" + t)
                                      .removeAttr("data-src")
                                      .css("opacity", 1),
                                      s(t);
                              })
                        : s(t),
                    d(n),
                    !0
                );
            },
            p = function() {
                if (!e.config.displayList) return !1;
                a();
                var i = e.plugin.find(".ps-list"),
                    t = i.width(),
                    n = e.plugin.find(".ps-list > ul"),
                    s = n.width();
                if (s > t) {
                    n.css("margin", "0 45px");
                    var l = parseInt(n.css("margin-left")),
                        o = parseInt(n.css("margin-right"));
                    (t -= l + o),
                        i
                            .find(".ps-prev")
                            .show()
                            .unbind("click")
                            .click(function() {
                                var i = parseInt(n.css("left")),
                                    e = i + t;
                                0 == i ? (e = -(s - t)) : e > 0 && (e = 0),
                                    n.css("left", e);
                            }),
                        i
                            .find(".ps-next")
                            .show()
                            .unbind("click")
                            .click(function() {
                                var i = parseInt(n.css("left")),
                                    e = i - t,
                                    l = -(s - t);
                                i == l ? (e = 0) : e < l && (e = l),
                                    n.css("left", e);
                            }),
                        e.config.touchControls &&
                            (e.plugin
                                .find(".ps-list > ul")
                                .on("touchmove", function(t) {
                                    try {
                                        if (
                                            t.originalEvent.touches[0].clientX
                                        ) {
                                            var s =
                                                0 == e.touchListLastPosition
                                                    ? 0
                                                    : e.touchListLastPosition;
                                            (nbPixels =
                                                0 == e.touchListLastPosition
                                                    ? 1
                                                    : Math.abs(
                                                          s -
                                                              t.originalEvent
                                                                  .touches[0]
                                                                  .clientX
                                                      )),
                                                (e.touchListLastPosition =
                                                    t.originalEvent.touches[0].clientX);
                                            var l = "";
                                            s >
                                            t.originalEvent.touches[0].clientX
                                                ? (l = "left")
                                                : s <
                                                      t.originalEvent.touches[0]
                                                          .clientX &&
                                                  (l = "right");
                                        }
                                        var o = parseInt(n.css("left"));
                                        if ("left" == l) {
                                            var a = i.width(),
                                                r = n.width(),
                                                c = parseInt(
                                                    n.css("margin-left")
                                                ),
                                                d = parseInt(
                                                    n.css("margin-right")
                                                );
                                            (u = o - nbPixels) >
                                                -(r - (a -= c + d)) &&
                                                n.css("left", u);
                                        } else if ("right" == l) {
                                            var u;
                                            (u = o + nbPixels) < 0
                                                ? n.css("left", u)
                                                : n.css("left", 0);
                                        }
                                    } catch (t) {
                                        e.touchListLastPosition = !1;
                                    }
                                }),
                            e.plugin
                                .find(".ps-list > ul")
                                .on("touchend", function(i) {
                                    e.touchListLastPosition = !1;
                                }));
                } else {
                    l = parseInt((t - s) / 2);
                    n.css("left", 0).css("margin-left", l),
                        i.find(".ps-prev").hide(),
                        i.find(".ps-next").hide(),
                        e.plugin
                            .find(".ps-list > ul")
                            .unbind("touchstart touchmove touchend");
                }
                return !0;
            },
            f = function() {
                var i = e.plugin.find(".ps-list").width(),
                    t = e.plugin.find(".ps-list > ul"),
                    n = t.width();
                i -=
                    parseInt(t.css("margin-left")) +
                    parseInt(t.css("margin-right"));
                var s = Math.abs(parseInt(t.css("left"))),
                    l = s + i,
                    o = e.plugin.find(".ps-list .ps-selected").position().left,
                    a = o + e.plugin.find(".ps-list .ps-selected").width();
                if (o < s || a > l || (n > i && l > a)) {
                    var r = -(n - i);
                    -o < r ? t.css("left", r) : t.css("left", -o);
                }
                return !0;
            };
        return (
            (e.getWallpaperID = function() {
                return e.data[e.currentSlide - 1].wallpaper_id;
            }),
            (e.getCurrentSlide = function() {
                return e.currentSlide;
            }),
            (e.getSlideCount = function() {
                return e.slideCount;
            }),
            (e.displaySlide = function(i) {
                return u(i), !0;
            }),
            (e.autoForward = function() {
                return (
                    (e.config.autoSlide = !0),
                    (e.config.directionSlide = "right"),
                    setTimeout(function() {
                        e.nextSlide();
                    }, 500),
                    !0
                );
            }),
            (e.autoBackward = function() {
                return (
                    (e.config.autoSlide = !0),
                    (e.config.directionSlide = "left"),
                    setTimeout(function() {
                        e.previousSlide();
                    }, 500),
                    !0
                );
            }),
            (e.pauseAutoSlide = function() {
                clearTimeout(e.intervalEvent),
                    (e.config.autoSlide = !1),
                    e.plugin.find(".ps-caption .el-pause").hide();
            }),
            (e.nextSlide = function() {
                return (
                    e.currentSlide + 1 <= e.slideCount
                        ? (e.config.autoSlide &&
                              "left" == e.config.directionSlide &&
                              e.pauseAutoSlide(),
                          u(e.currentSlide + 1))
                        : "none" != e.config.nextPage
                        ? (window.location.href = e.config.nextPage)
                        : u(1),
                    !0
                );
            }),
            (e.previousSlide = function() {
                return (
                    e.currentSlide - 1 >= 1
                        ? (e.config.autoSlide &&
                              "right" == e.config.directionSlide &&
                              e.pauseAutoSlide(),
                          u(e.currentSlide - 1))
                        : "none" != e.config.prevPage
                        ? (window.location.href = e.config.prevPage)
                        : u(e.slideCount),
                    !0
                );
            }),
            (e.destroy = function(t) {
                return (
                    clearInterval(e.intervalEvent),
                    void 0 !== t
                        ? (e.plugin.find(".ps-list > ul > li").each(function() {
                              i(this)
                                  .attr("style", null)
                                  .removeClass()
                                  .unbind("click"),
                                  i(this).html(
                                      i(this)
                                          .find("span")
                                          .html()
                                  );
                          }),
                          e.plugin.find(".ps-current").remove(),
                          e.plugin
                              .find(".ps-list")
                              .find(".ps-prev, .ps-next")
                              .remove(),
                          e.plugin
                              .find(".ps-list > ul")
                              .addClass(e.config.mainClassName)
                              .attr("style", ""),
                          e.plugin
                              .find(".ps-list > ul")
                              .unwrap()
                              .unwrap(),
                          e.hide())
                        : e
                              .parent()
                              .parent()
                              .remove(),
                    (e.plugin = null),
                    (e.data = []),
                    (e.config = {}),
                    (e.currentSlide = 0),
                    (e.slideCount = 0),
                    (e.resizeEvent = null),
                    (e.intervalEvent = null),
                    (e.touchFirstPosition = null),
                    (e.window = null),
                    !0
                );
            }),
            (e.config = i.extend({}, n, t)),
            r(),
            e.config.displayList && p(),
            e.window.resize(function() {
                visiblePopover && i(".moreInfoSlide").popover("hide"),
                    clearTimeout(e.resizeEvent),
                    (e.resizeEvent = setTimeout(function() {
                        var t = e.data[e.currentSlide - 1];
                        l(e.currentSlide, t.width, t.height),
                            o(e.currentSlide),
                            e.config.displayList && (p(), f()),
                            visiblePopover &&
                                i(".moreInfoSlide").popover("show");
                    }, 250));
            }),
            (document.onkeydown = function(i) {
                if (
                    "[object HTMLInputElement]" !=
                    ((i = i || window.event).target || i.srcElement)
                ) {
                    var t = i.which || i.keyCode;
                    70 == t
                        ? e.autoForward()
                        : 66 == t
                        ? e.autoBackward()
                        : 80 == t
                        ? e.pauseAutoSlide()
                        : 73 == t
                        ? showInfos()
                        : 39 == t
                        ? e.nextSlide()
                        : 37 == t && e.previousSlide();
                }
            }),
            this
        );
    };
})(window.jQuery);
